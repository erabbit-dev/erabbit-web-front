(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2b07c032"],{1885:function(e,t,c){},"1c43":function(e,t,c){"use strict";c("1885")},"2f1e":function(e,t,c){"use strict";c("4599")},4599:function(e,t,c){},"54dc":function(e,t,c){},"8e10":function(e,t,c){"use strict";c("54dc")},df61:function(e,t,c){"use strict";c.r(t);var o=c("7a23"),a=Object(o["withScopeId"])("data-v-ac29eec8");Object(o["pushScopeId"])("data-v-ac29eec8");var n=Object(o["createTextVNode"])("联合登录"),r={key:0,class:"container"},l=Object(o["createVNode"])("div",{class:"unbind"},[Object(o["createVNode"])("div",{class:"loading"})],-1),i={key:1,class:"container"},s={class:"tab"},u=Object(o["createVNode"])("i",{class:"iconfont icon-bind"},null,-1),d=Object(o["createVNode"])("span",null,"已有小兔鲜账号，请绑定手机",-1),b=Object(o["createVNode"])("i",{class:"iconfont icon-edit"},null,-1),m=Object(o["createVNode"])("span",null,"没有小兔鲜账号，请完善资料",-1),p={key:0,class:"tab-content"},j={key:1,class:"tab-content"};Object(o["popScopeId"])();var O=a((function(e,t,c,O,f,v){var k=Object(o["resolveComponent"])("LoginHeader"),V=Object(o["resolveComponent"])("CallbackBind"),h=Object(o["resolveComponent"])("CallbackPatch"),N=Object(o["resolveComponent"])("LoginFooter");return Object(o["openBlock"])(),Object(o["createBlock"])(o["Fragment"],null,[Object(o["createVNode"])(k,null,{default:a((function(){return[n]})),_:1}),O.isBind?(Object(o["openBlock"])(),Object(o["createBlock"])("section",r,[l])):(Object(o["openBlock"])(),Object(o["createBlock"])("section",i,[Object(o["createVNode"])("nav",s,[Object(o["createVNode"])("a",{onClick:t[1]||(t[1]=function(e){return O.hasAccount=!0}),class:{active:O.hasAccount},href:"javascript:;"},[u,d],2),Object(o["createVNode"])("a",{onClick:t[2]||(t[2]=function(e){return O.hasAccount=!1}),class:{active:!O.hasAccount},href:"javascript:;"},[b,m],2)]),O.hasAccount?(Object(o["openBlock"])(),Object(o["createBlock"])("div",p,[Object(o["createVNode"])(V,{unionId:O.unionId},null,8,["unionId"])])):(Object(o["openBlock"])(),Object(o["createBlock"])("div",j,[Object(o["createVNode"])(h,{unionId:O.unionId},null,8,["unionId"])]))])),Object(o["createVNode"])(N)],64)})),f=c("cc8e"),v=c("136e"),k=Object(o["withScopeId"])("data-v-5ca4600c");Object(o["pushScopeId"])("data-v-5ca4600c");var V={class:"user-info"},h={class:"xtx-form-item"},N={class:"field"},y=Object(o["createVNode"])("i",{class:"icon iconfont icon-phone"},null,-1),w={key:0,class:"error"},g={class:"xtx-form-item"},x={class:"field"},C=Object(o["createVNode"])("i",{class:"icon iconfont icon-code"},null,-1),B={key:0,class:"error"};Object(o["popScopeId"])();var I=k((function(e,t,c,a,n,r){var l=Object(o["resolveComponent"])("Field"),i=Object(o["resolveComponent"])("Form");return Object(o["openBlock"])(),Object(o["createBlock"])(i,{ref:"formCom","validation-schema":a.mySchema,autocomplete:"off",class:"xtx-form"},{default:k((function(e){var c=e.errors;return[Object(o["createVNode"])("div",V,[Object(o["createVNode"])("img",{src:a.avatar,alt:""},null,8,["src"]),Object(o["createVNode"])("p",null,"Hi，"+Object(o["toDisplayString"])(a.nickname)+" 欢迎来小兔鲜，完成绑定后可以QQ账号一键登录哦~",1)]),Object(o["createVNode"])("div",h,[Object(o["createVNode"])("div",N,[y,Object(o["createVNode"])(l,{class:[{err:c.mobile},"input"],modelValue:a.form.mobile,"onUpdate:modelValue":t[1]||(t[1]=function(e){return a.form.mobile=e}),name:"mobile",type:"text",placeholder:"绑定的手机号"},null,8,["class","modelValue"])]),c.mobile?(Object(o["openBlock"])(),Object(o["createBlock"])("div",w,Object(o["toDisplayString"])(c.mobile),1)):Object(o["createCommentVNode"])("",!0)]),Object(o["createVNode"])("div",g,[Object(o["createVNode"])("div",x,[C,Object(o["createVNode"])(l,{class:[{err:c.code},"input"],modelValue:a.form.code,"onUpdate:modelValue":t[2]||(t[2]=function(e){return a.form.code=e}),name:"code",type:"text",placeholder:"短信验证码"},null,8,["class","modelValue"]),Object(o["createVNode"])("span",{onClick:t[3]||(t[3]=function(e){return a.send()}),class:"code"},Object(o["toDisplayString"])(0===a.time?"发送验证码":"".concat(a.time,"秒后发送")),1)]),c.code?(Object(o["openBlock"])(),Object(o["createBlock"])("div",B,Object(o["toDisplayString"])(c.code),1)):Object(o["createCommentVNode"])("",!0)]),Object(o["createVNode"])("a",{onClick:t[4]||(t[4]=function(e){return a.submit()}),href:"javascript:;",class:"submit"},"立即绑定")]})),_:1},8,["validation-schema"])})),S=c("5530"),U=c("1da1"),F=(c("96cf"),c("691d")),_=c.n(F),P=c("7bb1"),D=c("9f94"),L=c("c24f"),Q=c("7bbe"),R=c("2f59"),A=c("5502"),H=c("6c02"),q={name:"CallbackBind",components:{Form:P["b"],Field:P["a"]},props:{unionId:{type:String,default:""}},setup:function(e){var t=Object(o["ref"])("null"),c=Object(o["ref"])("null");_.a.Login.check()&&_.a.api("get_user_info").success((function(e){c.value=e.data.figureurl_qq_1,t.value=e.data.nickname}));var a=Object(o["reactive"])({mobile:null,code:null}),n={mobile:D["a"].mobile,code:D["a"].code},r=Object(o["ref"])(null),l=Object(o["ref"])(0),i=Object(Q["u"])((function(){l.value--,l.value<=0&&s()}),1e3,!1),s=i.pause,u=i.resume;Object(o["onUnmounted"])((function(){s()}));var d=function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=n.mobile(a.mobile),!0===t?0===l.value&&Object(L["e"])(a.mobile).then((function(){Object(R["a"])({type:"success",text:"发送成功"}),l.value=60,u()})).catch((function(e){var t;Object(R["a"])({type:"error",text:(null===(t=e.response.data)||void 0===t?void 0:t.message)||"发送失败"})})):r.value.setFieldError("mobile",t);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=Object(A["b"])(),m=Object(H["d"])(),p=function(){var t=Object(U["a"])(regeneratorRuntime.mark((function t(){var c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:c=r.value.validate(),c&&Object(L["f"])(Object(S["a"])({unionId:e.unionId},a)).then((function(e){var t=e.result,c=t.id,o=t.account,a=t.avatar,n=t.mobile,r=t.nickname,l=t.token;b.commit("user/setUser",{id:c,account:o,avatar:a,mobile:n,nickname:r,token:l}),b.dispatch("cart/mergeCart").then((function(){m.push(b.state.user.redirectUrl),Object(R["a"])({type:"success",text:"QQ绑定成功"})}))})).catch((function(e){Object(R["a"])({type:"error",text:"绑定失败"})}));case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return{nickname:t,avatar:c,form:a,mySchema:n,send:d,time:l,formCom:r,submit:p}}};c("1c43");q.render=I,q.__scopeId="data-v-5ca4600c";var E=q,J=Object(o["withScopeId"])("data-v-447e9f44");Object(o["pushScopeId"])("data-v-447e9f44");var M={class:"xtx-form-item"},T={class:"field"},z=Object(o["createVNode"])("i",{class:"icon iconfont icon-user"},null,-1),G={key:0,class:"error"},K={class:"xtx-form-item"},W={class:"field"},X=Object(o["createVNode"])("i",{class:"icon iconfont icon-phone"},null,-1),Y={key:0,class:"error"},Z={class:"xtx-form-item"},$={class:"field"},ee=Object(o["createVNode"])("i",{class:"icon iconfont icon-code"},null,-1),te={key:0,class:"error"},ce={class:"xtx-form-item"},oe={class:"field"},ae=Object(o["createVNode"])("i",{class:"icon iconfont icon-lock"},null,-1),ne={key:0,class:"error"},re={class:"xtx-form-item"},le={class:"field"},ie=Object(o["createVNode"])("i",{class:"icon iconfont icon-lock"},null,-1),se={key:0,class:"error"};Object(o["popScopeId"])();var ue=J((function(e,t,c,a,n,r){var l=Object(o["resolveComponent"])("Field"),i=Object(o["resolveComponent"])("Form");return Object(o["openBlock"])(),Object(o["createBlock"])(i,{ref:"formCom","validation-schema":a.mySchema,class:"xtx-form",autocomplete:"off"},{default:J((function(e){var c=e.errors;return[Object(o["createVNode"])("div",M,[Object(o["createVNode"])("div",T,[z,Object(o["createVNode"])(l,{class:[{err:c.account},"input"],modelValue:a.form.account,"onUpdate:modelValue":t[1]||(t[1]=function(e){return a.form.account=e}),name:"account",type:"text",placeholder:"请输入用户名"},null,8,["class","modelValue"])]),c.account?(Object(o["openBlock"])(),Object(o["createBlock"])("div",G,Object(o["toDisplayString"])(c.account),1)):Object(o["createCommentVNode"])("",!0)]),Object(o["createVNode"])("div",K,[Object(o["createVNode"])("div",W,[X,Object(o["createVNode"])(l,{class:[{err:c.mobile},"input"],modelValue:a.form.mobile,"onUpdate:modelValue":t[2]||(t[2]=function(e){return a.form.mobile=e}),name:"mobile",type:"text",placeholder:"请输入手机号"},null,8,["class","modelValue"])]),c.mobile?(Object(o["openBlock"])(),Object(o["createBlock"])("div",Y,Object(o["toDisplayString"])(c.mobile),1)):Object(o["createCommentVNode"])("",!0)]),Object(o["createVNode"])("div",Z,[Object(o["createVNode"])("div",$,[ee,Object(o["createVNode"])(l,{class:[{err:c.code},"input"],modelValue:a.form.code,"onUpdate:modelValue":t[3]||(t[3]=function(e){return a.form.code=e}),name:"code",type:"text",placeholder:"请输入验证码"},null,8,["class","modelValue"]),Object(o["createVNode"])("span",{onClick:t[4]||(t[4]=function(e){return a.send()}),class:"code"},Object(o["toDisplayString"])(0===a.time?"发送验证码":"".concat(a.time,"秒后发送")),1)]),c.code?(Object(o["openBlock"])(),Object(o["createBlock"])("div",te,Object(o["toDisplayString"])(c.code),1)):Object(o["createCommentVNode"])("",!0)]),Object(o["createVNode"])("div",ce,[Object(o["createVNode"])("div",oe,[ae,Object(o["createVNode"])(l,{class:[{err:c.password},"input"],modelValue:a.form.password,"onUpdate:modelValue":t[5]||(t[5]=function(e){return a.form.password=e}),name:"password",type:"password",placeholder:"请输入密码"},null,8,["class","modelValue"])]),c.password?(Object(o["openBlock"])(),Object(o["createBlock"])("div",ne,Object(o["toDisplayString"])(c.password),1)):Object(o["createCommentVNode"])("",!0)]),Object(o["createVNode"])("div",re,[Object(o["createVNode"])("div",le,[ie,Object(o["createVNode"])(l,{class:[{err:c.rePassword},"input"],modelValue:a.form.rePassword,"onUpdate:modelValue":t[6]||(t[6]=function(e){return a.form.rePassword=e}),name:"rePassword",type:"password",placeholder:"请确认密码"},null,8,["class","modelValue"])]),c.rePassword?(Object(o["openBlock"])(),Object(o["createBlock"])("div",se,Object(o["toDisplayString"])(c.rePassword),1)):Object(o["createCommentVNode"])("",!0)]),Object(o["createVNode"])("a",{onClick:t[7]||(t[7]=function(e){return a.submit()}),href:"javascript:;",class:"submit"},"立即提交")]})),_:1},8,["validation-schema"])})),de={name:"CallbackPatch",components:{Form:P["b"],Field:P["a"]},props:{unionId:{type:String,default:""}},setup:function(e){var t=Object(o["reactive"])({account:null,mobile:null,code:null,password:null,rePassword:null}),c={account:D["a"].accountApi,mobile:D["a"].mobile,code:D["a"].code,password:D["a"].password,rePassword:D["a"].rePassword},a=Object(o["ref"])(null),n=Object(o["ref"])(0),r=Object(Q["u"])((function(){n.value--,n.value<=0&&l()}),1e3,!1),l=r.pause,i=r.resume;Object(o["onUnmounted"])((function(){l()}));var s=function(){var e=Object(U["a"])(regeneratorRuntime.mark((function e(){var o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:o=c.mobile(t.mobile),!0===o?0===n.value&&Object(L["h"])(t.mobile).then((function(){Object(R["a"])({type:"success",text:"发送成功"}),n.value=60,i()})).catch((function(e){var t;Object(R["a"])({type:"error",text:(null===(t=e.response.data)||void 0===t?void 0:t.message)||"发送失败"})})):a.value.setFieldError("mobile",o);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=Object(A["b"])(),d=Object(H["d"])(),b=function(){var c=Object(U["a"])(regeneratorRuntime.mark((function c(){var o;return regeneratorRuntime.wrap((function(c){while(1)switch(c.prev=c.next){case 0:o=a.value.validate(),o&&Object(L["i"])(Object(S["a"])({unionId:e.unionId},t)).then((function(e){var t=e.result,c=t.id,o=t.account,a=t.avatar,n=t.mobile,r=t.nickname,l=t.token;u.commit("user/setUser",{id:c,account:o,avatar:a,mobile:n,nickname:r,token:l}),u.dispatch("cart/mergeCart").then((function(){d.push(u.state.user.redirectUrl),Object(R["a"])({type:"success",text:"QQ完善信息成功"})}))})).catch((function(e){Object(R["a"])({type:"error",text:"完善信息失败"})}));case 2:case"end":return c.stop()}}),c)})));return function(){return c.apply(this,arguments)}}();return{form:t,mySchema:c,formCom:a,time:n,send:s,submit:b}}};c("2f1e");de.render=ue,de.__scopeId="data-v-447e9f44";var be=de,me={name:"LoginCallback",components:{LoginHeader:f["a"],LoginFooter:v["a"],CallbackBind:E,CallbackPatch:be},setup:function(){var e=Object(o["ref"])(!0),t=Object(o["ref"])(!0),c=Object(A["b"])(),a=Object(H["d"])(),n=Object(o["ref"])(null);return _.a.Login.check()&&_.a.Login.getMe((function(e){n.value=e,Object(L["g"])(e).then((function(e){var t=e.result,o=t.id,n=t.account,r=t.avatar,l=t.mobile,i=t.nickname,s=t.token;c.commit("user/setUser",{id:o,account:n,avatar:r,mobile:l,nickname:i,token:s}),c.dispatch("cart/mergeCart").then((function(){a.push(c.state.user.redirectUrl),Object(R["a"])({type:"success",text:"QQ登录成功"})}))})).catch((function(e){t.value=!1}))})),{hasAccount:e,isBind:t,unionId:n}}};c("8e10");me.render=O,me.__scopeId="data-v-ac29eec8";t["default"]=me}}]);
//# sourceMappingURL=chunk-2b07c032.d5147ee2.js.map